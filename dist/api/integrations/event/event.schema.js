var T=Object.create;var m=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty;var I=(t,e)=>{for(var r in e)m(t,r,{get:e[r],enumerable:!0})},d=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of b(e))!A.call(t,i)&&i!==r&&m(t,i,{get:()=>e[i],enumerable:!(o=v(e,i))||o.enumerable});return t};var E=(t,e,r)=>(r=t!=null?T(f(t)):{},d(e||!t||!t.__esModule?m(r,"default",{value:t,enumerable:!0}):r,t)),P=t=>d(m({},"__esModule",{value:!0}),t);var C={};I(C,{eventSchema:()=>O,pusherSchema:()=>x,webhookSchema:()=>D});module.exports=P(C);var h=E(require("crypto")),c=new Uint8Array(256),p=c.length;function u(){return p>c.length-16&&(h.default.randomFillSync(c),p=0),c.slice(p,p+=16)}var n=[];for(let t=0;t<256;++t)n.push((t+256).toString(16).slice(1));function y(t,e=0){return n[t[e+0]]+n[t[e+1]]+n[t[e+2]]+n[t[e+3]]+"-"+n[t[e+4]]+n[t[e+5]]+"-"+n[t[e+6]]+n[t[e+7]]+"-"+n[t[e+8]]+n[t[e+9]]+"-"+n[t[e+10]]+n[t[e+11]]+n[t[e+12]]+n[t[e+13]]+n[t[e+14]]+n[t[e+15]]}var g=E(require("crypto")),S={randomUUID:g.default.randomUUID};function N(t,e,r){if(S.randomUUID&&!e&&!t)return S.randomUUID();t=t||{};let o=t.random||(t.rng||u)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=o[i];return e}return y(o)}var a=N;var l=class l{constructor(e,r,o,i){this.prisma=e,this.monitor=r,this.status=o,this.name=i}set prisma(e){this.prismaRepository=e}get prisma(){return this.prismaRepository}set monitor(e){this.waMonitor=e}get monitor(){return this.waMonitor}set name(e){this.integrationName=e}get name(){return this.integrationName}set status(e){this.integrationStatus=e}get status(){return this.integrationStatus}async set(e,r){if(this.status)return r[this.name]?.enabled?r[this.name].events.length===0&&(r[this.name].events=l.events):r[this.name].events=[],this.prisma[this.name].upsert({where:{instanceId:this.monitor.waInstances[e].instanceId},update:{enabled:r[this.name]?.enabled,events:r[this.name].events},create:{enabled:r[this.name]?.enabled,events:r[this.name].events,instanceId:this.monitor.waInstances[e].instanceId}})}async get(e){if(!this.status)return;if(this.monitor.waInstances[e]===void 0)return null;let r=await this.prisma[this.name].findUnique({where:{instanceId:this.monitor.waInstances[e].instanceId}});return r||null}};l.events=["APPLICATION_STARTUP","QRCODE_UPDATED","MESSAGES_SET","MESSAGES_UPSERT","MESSAGES_EDITED","MESSAGES_UPDATE","MESSAGES_DELETE","SEND_MESSAGE","CONTACTS_SET","CONTACTS_UPSERT","CONTACTS_UPDATE","PRESENCE_UPDATE","CHATS_SET","CHATS_UPSERT","CHATS_UPDATE","CHATS_DELETE","GROUPS_UPSERT","GROUP_UPDATE","GROUP_PARTICIPANTS_UPDATE","CONNECTION_UPDATE","LABELS_EDIT","LABELS_ASSOCIATION","CALL","TYPEBOT_START","TYPEBOT_CHANGE_STATUS","REMOVE_INSTANCE","LOGOUT_INSTANCE"];var s=l;var U=(...t)=>{let e={};return t.forEach(r=>e[r]={minLength:1,description:`The "${r}" cannot be empty`}),{if:{propertyNames:{enum:[...t]}},then:{properties:e}}},x={$id:a(),type:"object",properties:{pusher:{type:"object",properties:{enabled:{type:"boolean"},appId:{type:"string"},key:{type:"string"},secret:{type:"string"},cluster:{type:"string"},useTLS:{type:"boolean"},events:{type:"array",minItems:0,items:{type:"string",enum:s.events}}},required:["enabled","appId","key","secret","cluster","useTLS"],...U("enabled","appId","key","secret","cluster","useTLS")}},required:["pusher"]};var _=(...t)=>{let e={};return t.forEach(r=>e[r]={minLength:1,description:`The "${r}" cannot be empty`}),{if:{propertyNames:{enum:[...t]}},then:{properties:e}}},D={$id:a(),type:"object",properties:{webhook:{type:"object",properties:{enabled:{type:"boolean"},url:{type:"string"},headers:{type:"object"},byEvents:{type:"boolean"},base64:{type:"boolean"},events:{type:"array",minItems:0,items:{type:"string",enum:s.events}}},required:["enabled","url"],..._("enabled","url")}},required:["webhook"]};var O={$id:a(),type:"object",properties:{websocket:{$ref:"#/$defs/event"},rabbitmq:{$ref:"#/$defs/event"},sqs:{$ref:"#/$defs/event"}},$defs:{event:{type:"object",properties:{enabled:{type:"boolean",enum:[!0,!1]},events:{type:"array",minItems:0,items:{type:"string",enum:s.events}}},required:["enabled"]}}};0&&(module.exports={eventSchema,pusherSchema,webhookSchema});
//# sourceMappingURL=event.schema.js.map