import d from"crypto";var p=new Uint8Array(256),m=p.length;function l(){return m>p.length-16&&(d.randomFillSync(p),m=0),p.slice(m,m+=16)}var n=[];for(let t=0;t<256;++t)n.push((t+256).toString(16).slice(1));function S(t,e=0){return n[t[e+0]]+n[t[e+1]]+n[t[e+2]]+n[t[e+3]]+"-"+n[t[e+4]]+n[t[e+5]]+"-"+n[t[e+6]]+n[t[e+7]]+"-"+n[t[e+8]]+n[t[e+9]]+"-"+n[t[e+10]]+n[t[e+11]]+n[t[e+12]]+n[t[e+13]]+n[t[e+14]]+n[t[e+15]]}import E from"crypto";var u={randomUUID:E.randomUUID};function h(t,e,r){if(u.randomUUID&&!e&&!t)return u.randomUUID();t=t||{};let i=t.random||(t.rng||l)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){r=r||0;for(let a=0;a<16;++a)e[r+a]=i[a];return e}return S(i)}var s=h;var c=class c{constructor(e,r,i,a){this.prisma=e,this.monitor=r,this.status=i,this.name=a}set prisma(e){this.prismaRepository=e}get prisma(){return this.prismaRepository}set monitor(e){this.waMonitor=e}get monitor(){return this.waMonitor}set name(e){this.integrationName=e}get name(){return this.integrationName}set status(e){this.integrationStatus=e}get status(){return this.integrationStatus}async set(e,r){if(this.status)return r[this.name]?.enabled?r[this.name].events.length===0&&(r[this.name].events=c.events):r[this.name].events=[],this.prisma[this.name].upsert({where:{instanceId:this.monitor.waInstances[e].instanceId},update:{enabled:r[this.name]?.enabled,events:r[this.name].events},create:{enabled:r[this.name]?.enabled,events:r[this.name].events,instanceId:this.monitor.waInstances[e].instanceId}})}async get(e){if(!this.status)return;if(this.monitor.waInstances[e]===void 0)return null;let r=await this.prisma[this.name].findUnique({where:{instanceId:this.monitor.waInstances[e].instanceId}});return r||null}};c.events=["APPLICATION_STARTUP","QRCODE_UPDATED","MESSAGES_SET","MESSAGES_UPSERT","MESSAGES_EDITED","MESSAGES_UPDATE","MESSAGES_DELETE","SEND_MESSAGE","CONTACTS_SET","CONTACTS_UPSERT","CONTACTS_UPDATE","PRESENCE_UPDATE","CHATS_SET","CHATS_UPSERT","CHATS_UPDATE","CHATS_DELETE","GROUPS_UPSERT","GROUP_UPDATE","GROUP_PARTICIPANTS_UPDATE","CONNECTION_UPDATE","LABELS_EDIT","LABELS_ASSOCIATION","CALL","TYPEBOT_START","TYPEBOT_CHANGE_STATUS","REMOVE_INSTANCE","LOGOUT_INSTANCE"];var o=c;var y=(...t)=>{let e={};return t.forEach(r=>e[r]={minLength:1,description:`The "${r}" cannot be empty`}),{if:{propertyNames:{enum:[...t]}},then:{properties:e}}},R={$id:s(),type:"object",properties:{pusher:{type:"object",properties:{enabled:{type:"boolean"},appId:{type:"string"},key:{type:"string"},secret:{type:"string"},cluster:{type:"string"},useTLS:{type:"boolean"},events:{type:"array",minItems:0,items:{type:"string",enum:o.events}}},required:["enabled","appId","key","secret","cluster","useTLS"],...y("enabled","appId","key","secret","cluster","useTLS")}},required:["pusher"]};var g=(...t)=>{let e={};return t.forEach(r=>e[r]={minLength:1,description:`The "${r}" cannot be empty`}),{if:{propertyNames:{enum:[...t]}},then:{properties:e}}},$={$id:s(),type:"object",properties:{webhook:{type:"object",properties:{enabled:{type:"boolean"},url:{type:"string"},headers:{type:"object"},byEvents:{type:"boolean"},base64:{type:"boolean"},events:{type:"array",minItems:0,items:{type:"string",enum:o.events}}},required:["enabled","url"],...g("enabled","url")}},required:["webhook"]};var j={$id:s(),type:"object",properties:{websocket:{$ref:"#/$defs/event"},rabbitmq:{$ref:"#/$defs/event"},sqs:{$ref:"#/$defs/event"}},$defs:{event:{type:"object",properties:{enabled:{type:"boolean",enum:[!0,!1]},events:{type:"array",minItems:0,items:{type:"string",enum:o.events}}},required:["enabled"]}}};export{j as eventSchema,R as pusherSchema,$ as webhookSchema};
//# sourceMappingURL=event.schema.mjs.map